<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8" />
    <title>Гараж</title>
    <link rel="icon" type="image/x-icon" href="./images/favicon.svg" />
    <analytics></analytics>
  </head>

  <body class="index">
    <div class="main">
      <h1>Вруб</h1>
      <h2>платформа о новой русской волне музыки</h2>

      <div class="menu">
        <a href="index.html">ПРОМО</a>
        <a href="./pages/page.html">О ПРОЕКТЕ</a>
      </div>

      <div class="bg_video">
        <video preload="auto" muted autoplay loop>
          <source src="videos/видос.webm" type="video/webm" />
        </video>
        <div class="form">
          <form
            id="my-form"
            action="https://formspree.io/f/xdorbvzr"
            method="POST"
          >
            <label
              >Оставьте контакты, чтобы узнать о дате запуска платформы</label
            >
            <input type="email" name="email" />
            <button id="my-form-button">Подписаться</button>
            <p id="my-form-status"></p>
          </form>
        </div>
      </div>

      <!-- форма для сбора почт -->

      <!-- Place this script at the end of the body tag -->
      <script>
        var form = document.getElementById('my-form')

        async function handleSubmit(event) {
          event.preventDefault()
          var status = document.getElementById('my-form-status')
          var data = new FormData(event.target)
          fetch(event.target.action, {
            method: form.method,
            body: data,
            headers: {
              Accept: 'application/json'
            }
          })
            .then((response) => {
              if (response.ok) {
                status.innerHTML = 'Спасибо!'
                form.reset()
              } else {
                response.json().then((data) => {
                  if (Object.hasOwn(data, 'errors')) {
                    status.innerHTML = data['errors']
                      .map((error) => error['message'])
                      .join(', ')
                  } else {
                    status.innerHTML = 'Упс! Возникла ошибка'
                  }
                })
              }
            })
            .catch((error) => {
              status.innerHTML = 'Упс! Возникла ошибка '
            })
        }
        form.addEventListener('submit', handleSubmit)
      </script>
    </div>
  </body>
</html>
